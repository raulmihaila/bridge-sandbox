{"version":3,"file":"auth.15368646.js","sources":["../../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/util/argsOrArgArray.js","../../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/combineLatest.js","../../../../node_modules/.pnpm/rxjs@7.5.5/node_modules/rxjs/dist/esm5/internal/operators/combineLatestWith.js","../../../hoppscotch-common/src/composables/auth.ts"],"sourcesContent":["var isArray = Array.isArray;\nexport function argsOrArgArray(args) {\n    return args.length === 1 && isArray(args[0]) ? args[0] : args;\n}\n//# sourceMappingURL=argsOrArgArray.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatestInit } from '../observable/combineLatest';\nimport { operate } from '../util/lift';\nimport { argsOrArgArray } from '../util/argsOrArgArray';\nimport { mapOneOrManyArgs } from '../util/mapOneOrManyArgs';\nimport { pipe } from '../util/pipe';\nimport { popResultSelector } from '../util/args';\nexport function combineLatest() {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n    }\n    var resultSelector = popResultSelector(args);\n    return resultSelector\n        ? pipe(combineLatest.apply(void 0, __spreadArray([], __read(args))), mapOneOrManyArgs(resultSelector))\n        : operate(function (source, subscriber) {\n            combineLatestInit(__spreadArray([source], __read(argsOrArgArray(args))))(subscriber);\n        });\n}\n//# sourceMappingURL=combineLatest.js.map","import { __read, __spreadArray } from \"tslib\";\nimport { combineLatest } from './combineLatest';\nexport function combineLatestWith() {\n    var otherSources = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        otherSources[_i] = arguments[_i];\n    }\n    return combineLatest.apply(void 0, __spreadArray([], __read(otherSources)));\n}\n//# sourceMappingURL=combineLatestWith.js.map","import {\n  currentUser$,\n  HoppUser,\n  AuthEvent,\n  authEvents$,\n  authIdToken$,\n} from \"@helpers/fb/auth\"\nimport {\n  map,\n  distinctUntilChanged,\n  filter,\n  Subscription,\n  combineLatestWith,\n} from \"rxjs\"\nimport { onBeforeUnmount, onMounted } from \"vue\"\n\n/**\n * A Vue composable function that is called when the auth status\n * is being updated to being logged in (fired multiple times),\n * this is also called on component mount if the login\n * was already resolved before mount.\n */\nexport function onLoggedIn(exec: (user: HoppUser) => void) {\n  let sub: Subscription | null = null\n\n  onMounted(() => {\n    sub = currentUser$\n      .pipe(\n        // We don't consider the state as logged in unless we also have an id token\n        combineLatestWith(authIdToken$),\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        filter(([_, token]) => !!token),\n        map((user) => !!user), // Get a logged in status (true or false)\n        distinctUntilChanged(), // Don't propagate unless the status updates\n        filter((x) => x) // Don't propagate unless it is logged in\n      )\n      .subscribe(() => {\n        exec(currentUser$.value!)\n      })\n  })\n\n  onBeforeUnmount(() => {\n    sub?.unsubscribe()\n  })\n}\n\n/**\n * A Vue composable function that calls its param function\n * when a new event (login, logout etc.) happens in\n * the auth system.\n *\n * NOTE: Unlike `onLoggedIn` for which the callback will be called once on mount with the current state,\n * here the callback will only be called on authentication event occurances.\n * You might want to check the auth state from an `onMounted` hook or something\n * if you want to access the initial state\n *\n * @param func A function which accepts an event\n */\nexport function onAuthEvent(func: (ev: AuthEvent) => void) {\n  let sub: Subscription | null = null\n\n  onMounted(() => {\n    sub = authEvents$.subscribe((ev) => {\n      func(ev)\n    })\n  })\n\n  onBeforeUnmount(() => {\n    sub?.unsubscribe()\n  })\n}\n"],"names":["isArray","argsOrArgArray","args","combineLatest","_i","resultSelector","popResultSelector","pipe","__spreadArray","__read","mapOneOrManyArgs","operate","source","subscriber","combineLatestInit","combineLatestWith","otherSources","onLoggedIn","exec","sub","onMounted","currentUser$","authIdToken$","filter","_","token","map","user","distinctUntilChanged","x","onBeforeUnmount","onAuthEvent","func","authEvents$","ev"],"mappings":"yJAAA,IAAIA,EAAU,MAAM,QACb,SAASC,EAAeC,EAAM,CACjC,OAAOA,EAAK,SAAW,GAAKF,EAAQE,EAAK,EAAE,EAAIA,EAAK,GAAKA,CAC7D,CCIO,SAASC,GAAgB,CAE5B,QADID,EAAO,CAAA,EACFE,EAAK,EAAGA,EAAK,UAAU,OAAQA,IACpCF,EAAKE,GAAM,UAAUA,GAEzB,IAAIC,EAAiBC,EAAkBJ,CAAI,EAC3C,OAAOG,EACDE,EAAKJ,EAAc,MAAM,OAAQK,EAAc,CAAA,EAAIC,EAAOP,CAAI,CAAC,CAAC,EAAGQ,EAAiBL,CAAc,CAAC,EACnGM,EAAQ,SAAUC,EAAQC,EAAY,CACpCC,EAAkBN,EAAc,CAACI,CAAM,EAAGH,EAAOR,EAAeC,CAAI,CAAC,CAAC,CAAC,EAAEW,CAAU,CAC/F,CAAS,CACT,CChBO,SAASE,GAAoB,CAEhC,QADIC,EAAe,CAAA,EACVZ,EAAK,EAAGA,EAAK,UAAU,OAAQA,IACpCY,EAAaZ,GAAM,UAAUA,GAEjC,OAAOD,EAAc,MAAM,OAAQK,EAAc,CAAA,EAAIC,EAAOO,CAAY,CAAC,CAAC,CAC9E,CCcO,SAASC,EAAWC,EAAgC,CACzD,IAAIC,EAA2B,KAE/BC,EAAU,IAAM,CACdD,EAAME,EACH,KAECN,EAAkBO,CAAY,EAE9BC,EAAO,CAAC,CAACC,EAAGC,CAAK,IAAM,CAAC,CAACA,CAAK,EAC9BC,EAAKC,GAAS,CAAC,CAACA,CAAI,EACpBC,EAAqB,EACrBL,EAAQM,GAAMA,CAAC,CACjB,EACC,UAAU,IAAM,CACfX,EAAKG,EAAa,KAAM,CAAA,CACzB,CAAA,CACJ,EAEDS,EAAgB,IAAM,CACpBX,GAAA,MAAAA,EAAK,aAAY,CAClB,CACH,CAcO,SAASY,EAAYC,EAA+B,CACzD,IAAIb,EAA2B,KAE/BC,EAAU,IAAM,CACRD,EAAAc,EAAY,UAAWC,GAAO,CAClCF,EAAKE,CAAE,CAAA,CACR,CAAA,CACF,EAEDJ,EAAgB,IAAM,CACpBX,GAAA,MAAAA,EAAK,aAAY,CAClB,CACH"}